<% SWITCH cmd %>
<% CASE 'USER_NOT_FOUND' %>
{
    "sendMessage": {
        "text": "<b>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –±–æ—Ç–∞ HQ VPN.</b> \n\n–ë–ª–∞–≥–æ–¥–∞—Ä—è –º–Ω–µ, –≤—ã –º–æ–∂–µ—Ç–µ –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ –Ω–∞—à–µ–º—É —Å–µ—Ä–≤–∏—Å—É. \n\n–î–ª—è –≤—Å–µ—Ö –Ω–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω <b>—Ç–µ—Å—Ç–æ–≤—ã–π –¥–æ—Å—Ç—É–ø –Ω–∞ 7 –¥–Ω–µ–π.</b> \n\n–ï—Å–ª–∏ —É –≤–∞—Å –±—ã–ª –∞–∫–∫–∞—É–Ω—Ç –ø–∏—à–∏—Ç–µ –≤ –ß–∞—Ç-–±–æ—Ç –ø–æ–¥–¥–µ—Ä–∂–∫–∏",
        "reply_markup": {
            "inline_keyboard": [
                [
                    {
                        "text": "–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è ‚úç",
                        "callback_data": "/register"
                    }
                ],
                [
                    {
                        "text": "–ö–∞–Ω–∞–ª üì£",
                        "url": "https://t.me/hq_vpn"
                    }
                ],
                [
                    {
                        "text": "–ì—Ä—É–ø–ø–∞ üó£",
                        "url": "https://t.me/hq_vpn_group"
                    }
                ],
                [
                    {
                        "text": "–ß–∞—Ç-–±–æ—Ç –ø–æ–¥–¥–µ—Ä–∂–∫–∏ üõ†",
                        "url": "https://t.me/HQ_VPN_HQ_BOT"
                    }
                ]
            ]
        }
    }
}
<% CASE '/register' %>
{
    "deleteMessage": { "message_id": {{ message.message_id }} }
},
{
    "shmRegister": {
        "callback_data": "/menu",
        "error": "–û–®–ò–ë–ö–ê: –õ–æ–≥–∏–Ω {{ message.chat.username }} –∏–ª–∏ chat_id {{ message.chat.id }} —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç"
    }
}
<% CASE ['/start', '/menu'] %>
{{ IF cmd == '/menu' }}
{
    "deleteMessage": { "message_id": {{ message.message_id }} }
},
{{ END }}
{
    "sendMessage": {
        "text": "<b>–°–æ–∑–¥–∞–≤–∞–π—Ç–µ –∏ —É–ø—Ä–∞–≤–ª—è–π—Ç–µ —Å–≤–æ–∏–º–∏ VPN –∫–ª—é—á–∞–º–∏.</b> \n\n–î–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –Ω–æ–≤–æ–π —É—Å–ª—É–≥–∏ –ø—Ä–µ–π–¥–∏—Ç–µ –≤ üóù <b>–ö–ª—é—á–∏</b> \n\n–ß—Ç–æ–± –ø–æ–ø–æ–ª–Ω–∏—Ç—å –±–∞–ª–∞–Ω—Å –ø–µ—Ä–µ–π–¥–∏—Ç–µ –≤ üí∞ <b>–ë–∞–ª–∞–Ωc</b> \n\n–ë–æ–ª–µ–µ –ø–æ–¥—Ä–æ–±–Ω–æ –æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏ –≤ –º–µ–Ω—é üëª <b>–ö–∞–∫ –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è</b>",
        "reply_markup": {
            "inline_keyboard": [
                [
                    {
                        "text": "üí∞ –ë–∞–ª–∞–Ω—Å",
                        "callback_data": "/balance"
                    }
                ],
                [
                    {
                        "text": "–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —É—Å–ª—É–≥  (üóù –ö–ª—é—á–∏)",
                        "callback_data": "/list"
                    }
                ],
                [
                    {
                        "text": "üëª –ö–∞–∫ –ø–æ–¥–∫–ª—é—á–∏—Ç—å—è",
                        "callback_data": "/help"
                    }
                ]
            ]
        }
    }
}
<% CASE '/balance' %>
{
    "deleteMessage": { "message_id": {{ message.message_id }} }
},
{
    "sendMessage": {
        "text": "üí∞ <b>–ë–∞–ª–∞–Ω—Å</b>: {{ user.balance }}\n\n–ù–µ–æ–±—Ö–æ–¥–∏–º–æ –æ–ø–ª–∞—Ç–∏—Ç—å: <b>{{ user.pays.forecast.total }}</b>",
        "reply_markup" : {
            "inline_keyboard": [
                [
                    {
                        "text": "‚úö –ü–æ–ø–æ–ª–Ω–∏—Ç—å –±–∞–ª–∞–Ω—Å –ö–∞—Ä—Ç–æ–π",
                        "url": "https://yoomoney.ru/quickpay/shop-widget?writer=seller&targets=%D0%9E%D0%BF%D0%BB%D0%B0%D1%82%D0%B0%20%D0%BF%D0%BE%20%D0%B4%D0%BE%D0%B3%D0%BE%D0%B2%D0%BE%D1%80%D1%83%20{{ user.id }}&targets-hint=&default-sum={{ user.pays.forecast.total }}&label={{ user.id }}&button-text=12&payment-type-choice=on&hint=&successURL=&quickpay=shop&account={{ config.pay_systems.yoomoney.account }}"
                    }
                ],
                [
                    {
                        "text": "üìñ –ü–æ–º–æ—â—å",
                        "callback_data": "/help"
                    },
                    {
                        "text": "üîô –í –º–µ–Ω—é",
                        "callback_data": "/menu"
                    }
                ]
            ]
        }
    }
}
<% CASE '/list' %>
{
    "deleteMessage": { "message_id": {{ message.message_id }} }
},
{
    "sendMessage": {
        "text": "üóù  –ö–ª—é—á–∏",
        "reply_markup" : {
            "inline_keyboard": [
                {{ FOR item IN ref( user.services.list_for_api( 'category', '%' ) ) }}
                {{ SWITCH item.status }}
                  {{ CASE 'ACTIVE' }}
                  {{ status = '‚úÖ' }}
                  {{ CASE 'BLOCK' }}
                  {{ status = '‚ùå' }}
                  {{ CASE 'NOT PAID' }}
                  {{ status = 'üí∞' }}
                  {{ CASE }}
                  {{ status = '‚è≥' }}
                {{ END }}
                [
                    {
                        "text": "{{ status }} - {{ item.name }}",
                        "callback_data": "/service {{ item.user_service_id }}"
                    }
                ],
                {{ END }}
                [
                    {
                        "text": "üõí –ù–æ–≤—ã–π –∫–ª—é—á",
                        "callback_data": "/pricelist"
                    }
                ],
                [
                    {
                        "text": "üìñ –ü–æ–º–æ—â—å",
                        "callback_data": "/help"
                    },
                    {
                        "text": "üîô –í –º–µ–Ω—é",
                        "callback_data": "/menu"
                    }
                ]
            ]
        }
    }
}
<% CASE '/service' %>
{{ us = user.services.list_for_api( 'usi', args.0 ) }}
{
    "deleteMessage": { "message_id": {{ message.message_id }} }
},
{
    "sendMessage": {
        "text": "<b>–ö–ª—é—á</b>: {{ us.name }}\n\n<b>–û–ø–ª–∞—á–µ–Ω –¥–æ</b>: {{ us.expire }}\n\n<b>–°—Ç–∞—Ç—É—Å</b>: {{ us.status }}",
        "reply_markup" : {
            "inline_keyboard": [
                {{ IF us.status == 'ACTIVE' }}
                [
                    {
                        "text": "üóù  –°–∫–∞—á–∞—Ç—å –∫–ª—é—á",
                        "callback_data": "/download_qr {{ args.0 }}"
                    },
                    {
                        "text": "üëÄ –ü–æ–∫–∞–∑–∞—Ç—å QR –∫–æ–¥",
                        "callback_data": "/show_qr {{ args.0 }}"
                    }
                ],
                {{ END }}
                {{ IF us.status != 'PROGRESS' }}
                [
                    {
                        "text": "‚ùå –£–¥–∞–ª–∏—Ç—å —É—Å–ª—É–≥—É",
                        "callback_data": "/delete {{ args.0 }}"
                    }
                ],
                {{ END }}
                [
                    {
                        "text": "üîô –ù–∞–∑–∞–¥",
                        "callback_data": "/list"
                    },
                    {
                        "text": "üîô –í –º–µ–Ω—é",
                        "callback_data": "/menu"
                    }
                ]
            ]
        }
    }
}
<% CASE '/pricelist' %>
{
    "deleteMessage": { "message_id": {{ message.message_id }} }
},
{
    "sendMessage": {
        "text": "‚ò∑ –í—ã–±–µ—Ä–∏—Ç–µ —É—Å–ª—É–≥—É –¥–ª—è –∑–∞–∫–∞–∑–∞",
        "reply_markup" : {
            "inline_keyboard": [
                {{ FOR item IN ref(service.api_price_list) }}
                [
                    {
                        "text": "üõí {{ item.name }}. –¶–µ–Ω–∞: {{ item.cost }}",
                        "callback_data": "/serviceorder {{ item.service_id }}"
                    }
                ],
                {{ END }}
                [
                    {
                        "text": "üîô –ù–∞–∑–∞–¥",
                        "callback_data": "/menu"
                    }
                ]
            ]
        }
    }
}
<% CASE '/serviceorder' %>
{
    "deleteMessage": { "message_id": {{ message.message_id }} }
},
{
    "sendMessage": {
        "text": "–í—ã –≤—ã–±—Ä–∞–ª–∏ —É—Å–ª—É–≥—É: {{ ref(service.api_service_by_id(args.0)).name }}. –¶–µ–Ω–∞: {{ ref(service.api_service_by_id(args.0)).cost }}. –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –∑–∞–∫–∞–∑",
        "reply_markup" : {
            "inline_keyboard": [
                [
                    {
                        "text": "‚úÖ –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å",
                        "callback_data": "/orderconfirm {{ args.0 }}"
                    }
                ],
                [
                    {
                        "text": "üîô –ù–∞–∑–∞–¥",
                        "callback_data": "/pricelist"
                    }
                ]
            ]
        }
    }
}
<% CASE '/orderconfirm' %>
{
    "shmServiceOrder": {
        "service_id": "{{ args.0 }}",
        "callback_data": "/balance",
        "error": "–û–®–ò–ë–ö–ê"
    }
},
{
    "sendMessage": {
        "text": "–í–∞—à –∑–∞–∫–∞–∑ –ø—Ä–∏–Ω—è—Ç! –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤–∞—à –±–∞–ª–∞–Ω—Å.",
        "reply_markup" : {
            "inline_keyboard": [
                [
                    {
                        "text": "üîô –í –º–µ–Ω—é",
                        "callback_data": "/menu"
                    }
                ]
            ]
        }
    }
}
<% CASE '/info' %>
{
    "sendMessage": {
        "parse_mode":"HTML",
        "text": "<b>User-id</b>: {{ user.id }}\n<b>Login</b>: {{ user.login }}\n<b>Chat-id</b>: {{ message.chat.id }}\n<b>Chat-username</b>: {{ message.chat.username }}"
    }
}
<% CASE '/help' %>
{
    "deleteMessage": { "message_id": {{ message.message_id }} }
},
{
    "sendMessage": {
        "parse_mode":"HTML",
        "text": "<b>–î–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ VPN, –≤—ã–ø–æ–ª–Ω–∏—Ç–µ —Å–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:</b> \n\n1Ô∏è‚É£  –°–∫–∞—á–∞–π—Ç–µ –∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ WireGuard –∫ —Å–µ–±–µ –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ. –°–∫–∞—á–∞—Ç—å –¥–ª—è <a href=\"https://apps.apple.com/us/app/wireguard/id1441195209\">iPhone</a>, <a href=\"https://play.google.com/store/apps/details?id=com.wireguard.android\">Android</a>, <a href=\"https://apps.apple.com/us/app/wireguard/id1451685025\">Mac</a>, <a href=\"https://download.wireguard.com/windows-client/wireguard-installer.exe\">Windows</a>.\n\n2Ô∏è‚É£  –í —Ä–∞–∑–¥–µ–ª–µ \"–ö–ª—é—á–∏\" –Ω–∞–∂–º–∏—Ç–µ \"–ù–æ–≤—ã–π –∫–ª—é—á\" –∏ –≤—ã–±–µ—Ä–∏—Ç–µ –Ω—É–∂–Ω—ã–π –≤–∞–º.\n\n3Ô∏è‚É£  –ü–æ—Å–ª–µ –æ–ø–ª–∞—Ç—ã —Å–∫–∞—á–∞–π—Ç–µ —Ñ–∞–π–ª –Ω–∞—Å—Ç—Ä–æ–µ–∫ –¥–ª—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è WireGuard. –ù–∞—Ö–æ–¥—è—Å—å –≤ –º–µ–Ω—é \"–ö–ª—é—á–∏\" –≤—ã–±–µ—Ä–∏—Ç–µ –Ω—É–∂–Ω—ã–π –∫–ª—é—á, –∫–ª–∏–∫–Ω—É–≤ –ø–æ –Ω–µ–º—É. –î–∞–ª–µ–µ —Å–∫–∞—á–∞–π—Ç–µ —Ñ–∞–π–ª –∫–ª—é—á–∞ –∏ –¥–æ–±–∞–≤—å—Ç–µ –µ–≥–æ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ WireGuard. \n\nüëâ –ü–æ–º–Ω–∏—Ç–µ, —á—Ç–æ –∫–∞–∂–¥—ã–π –∫–ª—é—á –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è –æ–¥–Ω–æ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –∏ –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ. \n\nüëâ –ï—Å–ª–∏ —É –≤–∞—Å –≤–æ–∑–Ω–∏–∫–Ω—É—Ç –≤–æ–ø—Ä–æ—Å—ã, –≤—ã –≤—Å–µ–≥–¥–∞ –º–æ–∂–µ—Ç–µ –æ–±—Ä–∞—Ç–∏—Ç—å—Å—è –∑–∞ –ø–æ–º–æ—â—å—é –∫ –Ω–∞—à–µ–º—É –ß–∞—Ç-–±–æ—Ç—É –ø–æ–¥–¥–µ—Ä–∂–∫–∏ üõ† –∏–ª–∏ –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç—å—Å—è –∫ –Ω–∞—à–µ–π –ì—Ä—É–ø–ø–µ üó£.",
        "reply_markup" : {
            "inline_keyboard": [
                [
                    {
                        "text": "–ß–∞—Ç-–±–æ—Ç –ø–æ–¥–¥–µ—Ä–∂–∫–∏ üõ†",
                        "url": "https://t.me/HQ_VPN_HQ_BOT"
                    }
                ],
                [
                    {
                        "text": "–ì—Ä—É–ø–ø–∞ üó£",
                        "url": "https://t.me/hq_vpn_group"
                    }
                ],
                [
                    {
                        "text": "üîô –í –º–µ–Ω—é",
                        "callback_data": "/menu"
                    }
                ]
            ]
        }
    }
}
<% END %>
